(function(t){function e(e){for(var o,s,r=e[0],l=e[1],c=e[2],p=0,u=[];p<r.length;p++)s=r[p],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&u.push(i[s][0]),i[s]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);d&&d(e);while(u.length)u.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],o=!0,r=1;r<a.length;r++){var l=a[r];0!==i[l]&&(o=!1)}o&&(n.splice(e--,1),t=s(s.s=a[0]))}return t}var o={},i={app:0},n=[];function s(e){if(o[e])return o[e].exports;var a=o[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=o,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(a,o,function(e){return t[e]}.bind(null,o));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var o=a("85ec"),i=a.n(o);i.a},"09b3":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var o=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("index")],1)},n=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("Modal",{attrs:{title:"密码验证",closable:!1,"mask-closable":!1},model:{value:t.pwdCheckModal,callback:function(e){t.pwdCheckModal=e},expression:"pwdCheckModal"}},[a("div",{staticStyle:{color:"red"}},[t._v(" 密 码 : "),a("i-input",{staticStyle:{width:"430px"},attrs:{type:"password",password:""},model:{value:t.pwd,callback:function(e){t.pwd=e},expression:"pwd"}})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("i-button",{attrs:{type:"primary"},on:{click:t.checkPwd}},[t._v(" 确认 ")])],1)])],1),t.show?a("div",{staticStyle:{margin:"20px 10px"}},[a("i-button",{attrs:{type:"primary",disabled:""==t.path},on:{click:t.back}},[t._v(" 返回上一层 ")]),a("i-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",disabled:""==t.path},on:{click:t.backRoot}},[t._v(" 返回根目录 ")]),a("i-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"success"},on:{click:t.toMkdir}},[t._v(" 创建文件夹 ")]),a("i-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"warning"},on:{click:function(e){return t.toUpload(!1)}}},[t._v(" 上传文件 ")]),a("i-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"warning"},on:{click:function(e){return t.toUpload(!0)}}},[t._v(" 上传文件夹 ")]),a("div",{staticStyle:{"margin-top":"15px"}},[a("List",[a("ListItem",{staticStyle:{"font-size":"1rem",color:"black"}},[a("span",{staticStyle:{width:"40%"}},[t._v("文件")]),a("span",{staticStyle:{width:"20%"}},[t._v("大小")]),a("span",{staticStyle:{width:"20%"}},[t._v("修改于")]),a("span",{staticStyle:{width:"20%"}},[t._v("操作")])]),t._l(t.files,(function(e,o){return a("ListItem",{key:o},[a("span",{staticStyle:{width:"40%"}},[a("span",{class:"fiv-viv fiv-icon-"+e.type,staticStyle:{"font-size":"2.5rem"}}),e.is_dir?a("i-button",{attrs:{type:"text"},on:{click:function(a){return t.showDir(e.name)}}},[a("span",{staticStyle:{color:"deepskyblue","font-size":"1rem"}},[t._v(" "+t._s(e.name)+" ")])]):t._e(),e.is_dir?t._e():a("a",{attrs:{href:e.staticPath,target:"_blank"}},[a("i-button",{attrs:{type:"text"}},[a("span",{staticStyle:{color:"black","font-size":"1rem"}},[t._v(" "+t._s(e.name)+" ")])])],1)],1),a("span",{staticStyle:{width:"20%"}},[t._v(" "+t._s(t.getSize(e))+" ")]),a("span",{staticStyle:{width:"20%"}},[t._v(" "+t._s(e.created_at)+" ")]),a("span",{staticStyle:{width:"20%"}},[e.is_dir?a("i-button",{attrs:{type:"primary"},on:{click:function(a){return t.showDir(e.name)}}},[t._v(" 进入 ")]):t._e(),e.is_dir?t._e():a("a",{attrs:{href:e.staticPath,target:"_blank"}},[a("i-button",{attrs:{type:"warning"}},[t._v(" 查看 ")])],1),e.is_dir?a("i-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info"},on:{click:function(a){return t.toDownload(e)}}},[t._v(" 下载 ")]):t._e(),e.is_dir?t._e():a("a",{staticStyle:{"margin-left":"10px"},attrs:{href:e.staticPath,download:e.name,target:"_blank"}},[a("i-button",{attrs:{type:"info"}},[t._v(" 下载 ")])],1),a("i-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"error"},on:{click:function(a){return t.deleteFile(e.name)}}},[t._v(" 删除 ")]),a("i-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:function(a){return t.toReName(e)}}},[t._v(" 重命名 ")])],1)])}))],2)],1),a("Modal",{attrs:{title:"创建文件夹"},model:{value:t.mkdirModal,callback:function(e){t.mkdirModal=e},expression:"mkdirModal"}},[a("div",{staticStyle:{color:"red"}},[t._v(" 文件夹名: "),a("i-input",{staticStyle:{width:"400px"},model:{value:t.dirName,callback:function(e){t.dirName=e},expression:"dirName"}})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("i-button",{attrs:{type:"text"},on:{click:function(e){t.mkdirModal=!1}}},[t._v(" 取消 ")]),a("i-button",{attrs:{type:"primary"},on:{click:t.mkdir}},[t._v(" 创建 ")])],1)]),a("Modal",{attrs:{title:"上传","mask-closable":!1,closable:!1},model:{value:t.uploadModal,callback:function(e){t.uploadModal=e},expression:"uploadModal"}},[a("Upload",{attrs:{multiple:"","before-upload":t.handleUpload,webkitdirectory:t.forDir,type:"drag",action:"//jsonplaceholder.typicode.com/posts/"}},[a("div",{staticStyle:{padding:"20px 0"}},[a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),t.forDir?a("p",{staticStyle:{color:"black"}},[t._v(" 选择文件夹 ")]):a("p",{staticStyle:{color:"black"}},[t._v(" 选择文件 ")])],1)]),t.uploads.length>0?a("div",{staticStyle:{"font-size":"18px","margin-top":"10px"}},[a("div",[t._v(" choosed file : ")]),t._l(Math.min(t.uploads.length,5),(function(e){return a("div",{key:e,staticStyle:{color:"red"}},[t.forDir?a("div",[t._v(" "+t._s(t.uploads[e-1].webkitRelativePath)+" ")]):a("div",[t._v(" "+t._s(t.uploads[e-1].name)+" ")])])})),t.uploads.length>5?a("div",[t._v("...")]):t._e(),a("div",{staticStyle:{"margin-top":"10px"}},[t._v(" 已选中 "),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.uploads.length)+" ")]),t._v(" 个文件, 总大小 "),a("span",{staticStyle:{color:"red"}},[t._v(t._s((t.totalSize/1048576).toFixed(2))+" MB ")])])],2):t._e(),t.doneSize>0?a("div",{staticStyle:{"font-size":"18px","margin-top":"5px"}},[a("Progress",{attrs:{percent:t.uploadPercent,"stroke-color":["#108ee9","#87d068"],"stroke-width":18,"text-inside":""}}),t._v(" 已上传 : "),a("span",{staticStyle:{color:"crimson"}},[t._v(" "+t._s((t.doneSize/1048576).toFixed(2))+" MB ")]),a("span",{staticStyle:{float:"right"}},[t._v("速率 : "),a("span",{staticStyle:{color:"crimson"}},[t._v(" "+t._s(t.uploadSpeed)+" MB/S ")])])],1):t._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("i-button",{attrs:{type:"text"},on:{click:function(e){t.uploadModal=!1}}},[t._v(" 取消 ")]),a("i-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v(" 上传 ")])],1)],1),a("Modal",{attrs:{title:t.readFileName},model:{value:t.readModal,callback:function(e){t.readModal=e},expression:"readModal"}},[a("div",{staticStyle:{margin:"10px 5px"}},[a("i-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:8},readonly:""},model:{value:t.fileContent,callback:function(e){t.fileContent=e},expression:"fileContent"}})],1)]),a("Modal",{attrs:{title:"下载","mask-closable":!1,closable:!1},model:{value:t.downModal,callback:function(e){t.downModal=e},expression:"downModal"}},[a("div",{staticStyle:{"font-size":"18px"}},[t._v(" 文件 : "),a("span",{staticStyle:{color:"crimson"}},[t._v(" "+t._s(t.downFile.name)+" ")]),t._v(" "),a("span",{staticStyle:{float:"right"}},[t._v(" 总大小 : "),a("span",{staticStyle:{color:"crimson"}},[t._v(t._s((t.downFile.size/1048576).toFixed(2))+" MB")])])]),a("div",{staticStyle:{"font-size":"18px","margin-top":"10px"}},[a("Progress",{attrs:{percent:t.downPercent,"stroke-color":["#108ee9","#87d068"],"stroke-width":18,"text-inside":""}}),t._v(" 已下载 : "),a("span",{staticStyle:{color:"crimson"}},[t._v(" "+t._s((t.downSize/1048576).toFixed(2))+" MB ")]),a("span",{staticStyle:{float:"right"}},[t._v("速率 : "),a("span",{staticStyle:{color:"crimson"}},[t._v(" "+t._s(t.downSpeed)+" MB/S ")])])],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("i-button",{attrs:{type:"primary"},on:{click:function(e){t.downCancel=!0}}},[t._v(" 取消 ")])],1)]),a("Modal",{attrs:{title:"重命名","mask-closable":!1,closable:!1,width:"400px"},model:{value:t.reNameModal,callback:function(e){t.reNameModal=e},expression:"reNameModal"}},[t.reNameFile?a("div",[a("i-input",{model:{value:t.newName,callback:function(e){t.newName=e},expression:"newName"}},[a("span",{attrs:{slot:"append"},slot:"append"},[t.reNameFile.is_dir?t._e():a("span",[t._v(".")]),t._v(t._s(t.reNameFile.type)+" ")])])],1):t._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("i-button",{attrs:{type:"text"},on:{click:function(e){t.reNameModal=!1}}},[t._v(" 取消 ")]),a("i-button",{attrs:{type:"primary"},on:{click:t.reName}},[t._v(" 确认 ")])],1)])],1):t._e()])},r=[],l=(a("c975"),a("baa5"),a("fb6a"),a("b0c0"),a("a9e3"),a("b680"),a("d3b7"),a("3ca3"),a("498a"),a("ddb0"),a("2b3d"),a("b85c")),c=a("ecc0"),d={name:"Index",data:function(){return{tmpFile:"fiv-cla fiv-icon-pdf",show:!1,columns:[{title:"文件名",slot:"name"},{title:"文件类型",key:"type"},{title:"文件大小",key:"size"},{title:"创建时间",key:"created_at"},{title:"操作",slot:"action"}],files:[],chunk_size:10485760,path:"",mkdirModal:!1,dirName:"",uploadModal:!1,uploads:[],forDir:!1,totalSize:0,doneSize:0,trueUpload:0,uploadPercent:0,uploadSpeed:0,uploadError:!1,uploadLast:0,uploadCir:0,uploadLastTime:0,downModal:!1,downFile:{name:"",size:0},downPercent:0,downSize:0,downSpeed:0,downCancel:!1,fileContent:"",readFileName:"",readModal:!1,pwdCheckModal:!1,pwd:"",reNameFile:null,reNameModal:!1,newName:""}},methods:{handleUpload:function(t){return this.uploads.push(t),this.totalSize+=t.size,!1},toUpload:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.axiosGet("checkLogin",{}).then((function(a){t.totalSize=t.doneSize=t.trueUpload=t.uploadPercent=t.uploadSpeed=t.uploadCir=t.uploadLast=0,t.uploadLastTime=(new Date).getTime(),t.forDir=e,t.uploads=[],t.uploadError=!1,t.uploadModal=!0}))},upload:function(t,e,a){var o=this,i=this.$axios.CancelToken,n=i.source(),s=0,r=a.size;this.$axios.post(t,e,{headers:{"Content-Type":"multipart/form-data"},params:a,cancelToken:n.token,onUploadProgress:function(t){if(o.uploadModal){if(s<r){if(o.doneSize+=Math.min(t.loaded,r)-s,s=t.loaded,0==o.uploadCir){var e=(new Date).getTime();o.uploadSpeed=((o.doneSize-o.uploadLast)/(1048.576*(e-o.uploadLastTime))).toFixed(2),o.uploadLastTime=e,o.uploadLast=o.doneSize}o.uploadCir+=1,o.uploadCir>=20&&(o.uploadCir=0),o.doneSize<o.totalSize&&(o.uploadPercent=Number((o.doneSize/o.totalSize*100).toFixed(2)))}}else n.cancel("stop upload")}}).then((function(t){o.trueUpload+=a.size,o.trueUpload>=o.totalSize&&(o.uploadPercent=100,setTimeout((function(){alert("上传成功"),o.uploadModal=!1,o.showDir()}),1e3))})).catch((function(t){o.$axios.isCancel(t)||o.uploadError||(o.uploadError=!0,o.uploadModal=!1,alert("上传出错"))}))},submit:function(){var t,e="/submit",a=Object(l["a"])(this.uploads);try{for(a.s();!(t=a.n()).done;)for(var o=t.value,i=Math.ceil(o.size/this.chunk_size),n=0;n<i;n++){if(this.uploadError||!this.uploadModal)return;var s=new FormData,r=o.slice(n*this.chunk_size,(n+1)*this.chunk_size);s.set("blob",r);var c={name:this.path+"/"+o.name};this.forDir&&(c.name=this.path+"/"+o.webkitRelativePath),c.offset=n*this.chunk_size,c.size=r.size,this.upload(e,s,c)}}catch(d){a.e(d)}finally{a.f()}},toDownload:function(t){t.is_dir?this.downFile.name=t.name+".zip":this.downFile.name=t.name,this.downFile.size=0,this.downPercent=this.downSize=0,this.downCancel=!1,this.download3(t)},download:function(t){var e="/download",a=this.path+"/"+t.name;this.$axios({url:e,method:"GET",responseType:"blob",params:{path:a}}).then((function(e){var a=window.URL.createObjectURL(new Blob([e.data])),o=document.createElement("a");o.href=a,t.is_dir?o.setAttribute("download","data.zip"):o.setAttribute("download",t.name),document.body.appendChild(o),o.click()}))},download3:function(t){var e=this,a=this.$axios.CancelToken,o=a.source(),i="/download",n=this.path+"/"+t.name,s=(new Date).getTime(),r=0,l=0;this.$axios({method:"GET",url:i,params:{path:n},responseType:"blob",cancelToken:o.token,onDownloadProgress:function(t){if(e.downCancel)return o.cancel("stop download"),void(e.downModal=!1);if(0==l){var a=(new Date).getTime();e.downSpeed=((t.loaded-r)/(1048.576*(a-s))).toFixed(2),s=a,r=t.loaded}l+=1,l>=20&&(l=0),e.downPercent=Number((t.loaded/t.total*100).toFixed(2)),e.downSize=t.loaded,e.downModal||(e.downFile.size=t.total,e.downModal=!0)}}).then((function(t){var a=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});Object(c["saveAs"])(a,e.downFile.name),setTimeout((function(){alert("下载成功"),e.downModal=!1}),3e3)})).catch((function(t){e.$axios.isCancel(t)?e.$message("info","已取消"):alert("下载出错"),e.downModal=!1}))},back:function(){this.path=this.path.substring(0,this.path.lastIndexOf("/")),this.showDir()},backRoot:function(){this.path="",this.showDir()},showDir:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";""!=e&&(this.path+="/"+e),this.axiosGet("/showDir",{path:this.path}).then((function(e){t.files=e;var a,o=Object(l["a"])(t.files);try{for(o.s();!(a=o.n()).done;){var i=a.value;""!=t.path?i.staticPath="/static/"+t.path+"/"+i.name:i.staticPath="/static/"+i.name}}catch(n){o.e(n)}finally{o.f()}})).catch((function(e){t.$message("error",e)}))},showDirOrLookUp:function(t){t.is_dir?this.showDir(t.name):this.lookup(t.name)},lookup:function(t){var e=this;this.axiosGet("/lookup",{path:this.path+"/"+t}).then((function(a){e.readFileName=t,e.fileContent=a,e.readModal=!0})).catch((function(t){e.$message("error",t)}))},toMkdir:function(){var t=this;this.axiosGet("checkLogin",{}).then((function(e){t.mkdirModal=!0}))},mkdir:function(){var t=this;this.dirName=this.dirName.trim(),""!=this.dirName?this.axiosGet("/mkdir",{path:this.path+"/"+this.dirName}).then((function(e){t.$message("success","创建成功"),t.dirName="",t.showDir(),t.mkdirModal=!1})).catch((function(e){t.$message("error",e)})):this.$message("error","文件夹名不能为空")},deleteFile:function(t){var e=this;this.$Modal.confirm({title:"确认框",content:'<div style="font-size: 18px;color: black"> 你确定要删除 <span style="color: red">'+t+"  </span> 吗?</div>",onOk:function(){e.axiosGet("/delete",{path:e.path+"/"+t}).then((function(t){e.$message("success","删除成功"),e.showDir()})).catch((function(t){e.$message("error",t)}))}})},cancel:function(){this.file=null},toReName:function(t){this.reNameFile=t,this.newName="",this.reNameModal=!0},reName:function(){var t=this;this.newName=this.newName.trim(),0!=this.newName.length?-1==this.newName.indexOf("/")?this.reNameFile.is_dir&&-1!=this.newName.indexOf(".")?this.$message("error","文件夹名不能出现 . "):this.axiosGet("/reName",{path:this.path,orgName:this.reNameFile.name,newName:this.newName}).then((function(e){t.$message("success","重命名成功"),t.reNameModal=!1,t.showDir()})).catch((function(e){t.$message("error",e)})):this.$message("error","文件夹名不能出现 / "):this.$message("error","文件名不能为空")},checkPwd:function(){var t=this,e=new FormData;e.set("pwd",this.pwd),this.$axios.post("checkPwd",e).then((function(e){t.$message("success","验证成功"),t.pwdCheckModal=!1,t.show||(t.showDir(),t.show=!0)})).catch((function(e){t.$message("error",e.response.data)}))},axiosGet:function(t,e){var a=this;return new Promise((function(o,i){a.$axios.get(t,{params:e}).then((function(t){o(t.data)})).catch((function(t){401==t.response.status&&(a.pwdCheckModal=!0),i(t.response.data)}))}))},autologin:function(){var t=this;this.axiosGet("checkLogin",{}).then((function(e){t.show=!0,t.showDir()}))},getSize:function(t){return t.is_dir?"---":t.size<1024?t.size+" B":t.size<1048576?(t.size/1024).toFixed(2)+" KB":t.size<1073741824?(t.size/1048576).toFixed(2)+" MB":(t.size/1073741824).toFixed(2)+" MB"}},mounted:function(){this.autologin()}},p=d,u=(a("c48c"),a("2877")),h=Object(u["a"])(p,s,r,!1,null,"12ccffa4",null),f=h.exports,m={name:"App",components:{Index:f}},v=m,w=(a("034f"),Object(u["a"])(v,i,n,!1,null,null,null)),y=w.exports,b=(a("fcad"),a("b6ce"),a("8587")),_=a.n(b),k=(a("4160"),a("b64b"),a("159b"),a("5530")),x=a("dad0"),S=a("ff16"),g=a("d7e4"),M=a("ffcb"),z=a("32c2"),N=a("83ae"),F=a("2ace"),P=a("a76b"),$=a("662b"),D={Button:$["a"],Divider:P["a"],Icon:F["a"],Input:N["a"],List:z["a"],ListItem:z["a"].Item,ListItemMeta:z["a"].Item.Meta,Message:M["a"],Modal:g["a"],Progress:S["a"],Upload:x["a"]},C=Object(k["a"])(Object(k["a"])({},D),{},{iButton:$["a"],iInput:N["a"]});Object.keys(C).forEach((function(t){o["a"].component(t,C[t])}));var O=function(t,e){M["a"][t]({background:!0,content:e})};o["a"].prototype.$Modal=g["a"],o["a"].prototype.$message=O,o["a"].prototype.$axios=_.a,o["a"].config.productionTip=!1,new o["a"]({render:function(t){return t(y)}}).$mount("#app")},"85ec":function(t,e,a){},c48c:function(t,e,a){"use strict";var o=a("09b3"),i=a.n(o);i.a}});